from pathlib import Path
import pydicom
import matplotlib.pyplot as plt
import numpy as np
import cv2 as cv
import numpy.ma as ma
import scipy.ndimage
from skimage import morphology
from skimage import measure
from skimage.transform import resize



def make_mask(imageArray, display=False):
    imghound=scale_to_hu(imageArray)
    kernel = np.ones((7,7),np.uint8)
    erosion = cv.erode(imghound,kernel,iterations = 2)
    kernel2 = np.ones((20,20),np.uint8)
    dilate = cv.dilate(erosion,kernel2,iterations = 2)
    threshhold=np.where(dilate<-500,0,1)
  
    

    mask = morphology.area_closing(threshhold, 100000, connectivity=1)
    


    final =  imghound*mask;
   
    final[final==0] = -1000;
   
    